---
title: "Fehler und ihre Behebung"
author: "Wolfgang Höfer"
format: revealjs
jupyter: python3
---

# Einfache Fehler

* Datei aus Commit restaurieren
* Komplett auf Commit zurücksetzen
* Suchen gehen


# Dateien restaurieren

--- 

Aus dem Stage

```bash
git restore <datei>
```

---

Beispiel

::: {.fragment}
```bash
git init beispiel_1
cd beispiel_1
git branch -m main
```
:::
::: {.fragment}
```bash
# Inhalt ok
echo "Alles gut" > datei.txt
git add .
git commit -m "alles gut"
```
:::

::: {.fragment}
```bash
# Inhalt falsch
echo "Mist gebaut" >> datei.txt
```
:::

::: {.fragment}
```bash
###### Alte Version vom Stage wieder herstellen
git restore datei.txt
```
:::

---

Nach einem voreiligen *add*

::: {.fragment}
```bash
# alles funktioniert
echo "Alles gut" > datei.txt
git add .
git commit -m "alles gut"

# Hier kommt der Fehler
echo "Mist gebaut" >> datei.txt
git add . # DAS ist anders!
```
:::

::: {.fragment}
Mit dem Hash vom letzten Commit:

```bash
git restore --source=<HASH> datei.txt
```
:::

---

### Problem

::: {.fragment}
Das geht mit jedem Commit, überschreibt 
aber immer die aktuelle Datei!
:::

:::{.fragment}
**Lösung**

```bash
git show <HASH>:datei.txt > datei_alt.txt
```
:::

## Größere Fehler

Rücksetzen auf frühere Stände -- Varianten

---

Hard 

```bash
git reset --hard <commit-hash>  # alles ab bestimmtem commit 
git reset --hard HEAD           # alles Neue ist weg
```

Probleme im Team, wegen Änderung der History, falls der 
aktuelle Stand bereits veröffentlicht war.

---

Mixed (Quasi Standard)

```bash
git reset --soft <commit-hash>  # nur Workdir bleibt erhalten
git reset <commit-hash>
```

--- 

Soft

```bash
git reset --soft <commit-hash>  # auch Stage bleibt erhalten
```

# Commits auschecken

```bash
git checkout xxxx
```

--- 

Vorbereitung

```bash
rm -rf lab

git init lab
cd lab
git branch -m main

for i in {1..10}
do
  echo "Inhalt $i" >> datei.txt
  git add .
  git commit -m "commit $i"
done
```

---

Log betrachten

```bash
git log --oneline

# Ausgabe
5712ee5 (HEAD -> main) commit 10
1e6a362 commit 9
3c28406 commit 8
13d8062 commit 7
+59e461f commit 6
b07f6f1 commit 5
92f8c26 commit 4
9f216de commit 3
07c0acd commit 2
8e0a9ab commit 1
```

---

Auschecken von Commit 4

```bash
git checkout 92f8c26
```

Warnung über *detached Head*

---

Log betrachten

```bash
git log --oneline 

# Ausgabe
92f8c26 (HEAD) commit 4
9f216de commit 3
07c0acd commit 2
8e0a9ab commit 1
```

Beachte: Kein *main* zu sehen!

---

Log im Detail

```bash
git log --oneline --all --date-order
# oder --topo-order

# Ausgabe
5712ee5 (main) commit 10
1e6a362 commit 9
3c28406 commit 8
13d8062 commit 7
59e461f commit 6
b07f6f1 commit 5
92f8c26 (HEAD) commit 4
9f216de commit 3
07c0acd commit 2
8e0a9ab commit 1
```

---

Rücksprung

```bash
git checkout main 
```
